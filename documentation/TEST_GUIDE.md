# P2P 聊天应用测试指南

## 🚀 快速开始

### 环境要求
- Java 11 或更高版本
- Maven 3.6 或更高版本
- 支持 JavaFX 的系统环境

### 编译项目
```bash
cd P2pChat
mvn clean compile
```

## 🎯 运行应用

### 方法一：使用 JavaFX Maven 插件（推荐）
```bash
# 启动第一个节点（默认端口 8080）
mvn javafx:run

# 启动第二个节点（端口 8081，连接到第一个节点）
mvn javafx:run -Djavafx.args="8081 localhost:8080"

# 启动第三个节点（端口 8082，连接到第二个节点）
mvn javafx:run -Djavafx.args="8082 localhost:8081"
```

### 方法二：使用命令行模式
```bash
# 启动命令行版本（用于调试网络功能）
mvn exec:java -Dexec.mainClass="com.yourgroup.chat.Main" -Dexec.args="8080"
mvn exec:java -Dexec.mainClass="com.yourgroup.chat.Main" -Dexec.args="8081 localhost:8080"
```

## 🧪 功能测试

### 1. 基础网络连接测试

**步骤：**
1. 启动第一个节点：`mvn javafx:run`
2. 启动第二个节点：`mvn javafx:run -Djavafx.args="8081 localhost:8080"`
3. 观察两个窗口的连接状态

**预期结果：**
- 两个窗口都显示 "连接数: 1"
- 在线成员列表显示对方节点
- 系统消息显示连接成功

### 2. 群聊功能测试

**步骤：**
1. 确保至少有两个节点连接
2. 在任一节点的输入框中输入消息
3. 点击"发送"按钮或按 Enter 键

**预期结果：**
- 发送的消息在本地显示为蓝色气泡（右对齐）
- 其他节点收到消息显示为白色气泡（左对齐）
- 消息包含发送者ID和时间戳

### 3. 私聊功能测试

**步骤：**
1. 在成员列表中双击任一在线成员
2. 私聊窗口应该弹出
3. 在私聊窗口中发送消息

**预期结果：**
- 弹出独立的私聊窗口
- 私聊消息只在对应的私聊窗口中显示
- 主窗口显示 "[私聊]" 标记的消息
- 可以同时打开多个私聊窗口

### 4. 表情功能测试

**步骤：**
1. 点击输入框旁边的 😊 按钮
2. 表情选择器弹出
3. 点击任意表情
4. 发送包含表情的消息

**预期结果：**
- 表情选择器正确显示4个分类
- 点击表情后插入到光标位置
- 表情在消息中正确显示

### 5. 文件传输功能测试

**步骤：**
1. 点击 📁 文件按钮
2. 选择一个文件
3. 观察接收方的反应

**预期结果：**
- 发送方显示"正在发送文件"消息
- 接收方弹出确认对话框
- 接受后显示文件传输消息

### 6. 多节点网络测试

**步骤：**
1. 启动3个或更多节点
2. 形成网络拓扑：A-B-C
3. 在节点A发送消息

**预期结果：**
- 消息通过洪泛算法传播到所有节点
- 每个节点都能收到消息
- 消息不会重复显示

## 🔧 故障排除

### 常见问题

**1. JavaFX 运行时错误**
```
Error: JavaFX runtime components are missing
```
**解决方案：**
- 确保使用 Java 11+ 并安装了 JavaFX
- 使用 `mvn javafx:run` 而不是直接运行 jar

**2. 端口占用错误**
```
java.net.BindException: Address already in use
```
**解决方案：**
- 使用不同的端口号
- 检查并关闭占用端口的进程

**3. 连接失败**
```
无法连接到节点
```
**解决方案：**
- 确保目标节点已启动
- 检查防火墙设置
- 验证IP地址和端口号

### 调试模式

启用详细日志输出：
```bash
mvn javafx:run -Djavafx.options="-Djava.util.logging.level=ALL"
```

## 📊 性能测试

### 网络延迟测试
1. 启动多个节点
2. 发送大量消息
3. 观察消息传播延迟

### 内存使用测试
1. 长时间运行应用
2. 发送大量消息和文件
3. 监控内存使用情况

### 并发连接测试
1. 启动10+个节点
2. 同时进行多个私聊
3. 测试系统稳定性

## 🎨 界面测试

### 响应式设计测试
- 调整窗口大小
- 测试不同分辨率
- 验证布局适应性

### 表情显示测试
- 测试各种Unicode表情
- 验证表情在不同系统上的显示
- 测试表情选择器的性能

## 📝 测试报告模板

```
测试日期：
测试环境：
Java版本：
操作系统：

功能测试结果：
- [ ] 基础网络连接
- [ ] 群聊功能
- [ ] 私聊功能
- [ ] 表情功能
- [ ] 文件传输
- [ ] 多节点网络

发现的问题：
1. 
2. 
3. 

建议改进：
1. 
2. 
3. 
```

## 🚀 高级测试场景

### 网络分区测试
1. 启动5个节点形成网络
2. 断开中间节点的连接
3. 观察网络自愈能力

### 大文件传输测试
1. 尝试传输大文件（>100MB）
2. 测试传输过程中的稳定性
3. 验证文件完整性

### 长时间运行测试
1. 让应用运行24小时以上
2. 定期发送消息和文件
3. 监控内存泄漏和性能下降

---

**注意：** 这是一个教育项目，请在安全的网络环境中进行测试。
