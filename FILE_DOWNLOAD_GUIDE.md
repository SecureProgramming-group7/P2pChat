# P2P聊天应用文件下载指南

## 文件下载位置

### 默认下载目录
接受的文件会默认保存在以下位置：
```
用户主目录/P2PChat_Downloads/
```

具体路径示例：
- **Windows**: `C:\Users\[用户名]\P2PChat_Downloads\`
- **macOS**: `/Users/[用户名]/P2PChat_Downloads/`
- **Linux**: `/home/[用户名]/P2PChat_Downloads/`

### 自定义保存位置
当收到文件传输请求时，您可以：
1. **选择自定义位置**：点击"是否接受"对话框中的"确定"后，会弹出文件保存对话框
2. **使用默认位置**：如果取消文件保存对话框，文件会自动保存到默认下载目录

### 文件命名规则
- 如果目标位置已存在同名文件，系统会自动添加数字后缀
- 例如：`document.pdf` → `document_1.pdf` → `document_2.pdf`

## 文件接收流程

### 1. 接收文件传输请求
当有用户向您发送文件时，会弹出确认对话框显示：
- 发送者信息
- 文件名
- 文件大小（自动格式化为 bytes/KB/MB）

### 2. 选择接受或拒绝
- **接受**：点击"确定"按钮
- **拒绝**：点击"取消"按钮

### 3. 选择保存位置（仅在接受时）
- 系统会打开文件保存对话框
- 默认目录为 `P2PChat_Downloads`
- 可以修改文件名和保存位置
- 点击"保存"确认，或"取消"使用默认位置

### 4. 文件传输状态
- 接受后会在聊天界面显示确认信息
- 显示文件保存路径
- 发送方会收到接受/拒绝的通知

## 目录结构示例

```
P2PChat_Downloads/
├── images/
│   ├── photo1.jpg
│   └── screenshot.png
├── documents/
│   ├── report.pdf
│   └── presentation.pptx
└── other_files/
    ├── archive.zip
    └── data.csv
```

## 安全提示

### 文件安全
- 接收文件前请确认发送者身份
- 对于可执行文件（.exe, .bat, .sh等）要特别谨慎
- 建议使用杀毒软件扫描接收的文件

### 存储空间
- 接收大文件前请确保有足够的磁盘空间
- 当前文件大小限制为 100MB
- 可以在设置中查看和管理下载的文件

## 故障排除

### 常见问题

**Q: 找不到下载的文件？**
A: 检查聊天记录中显示的保存路径，或查看默认下载目录

**Q: 文件下载失败？**
A: 可能的原因：
- 磁盘空间不足
- 文件路径权限问题
- 网络连接中断

**Q: 如何更改默认下载目录？**
A: 目前需要在每次接收文件时手动选择，后续版本将添加设置选项

### 技术限制
- 当前版本只支持文件传输请求确认
- 实际的文件数据传输功能正在开发中
- 暂不支持断点续传和传输进度显示

## 后续功能规划

### 即将推出
- 实际文件数据传输
- 传输进度显示
- 传输速度显示
- 取消传输功能

### 长期规划
- 断点续传
- 批量文件传输
- 文件加密传输
- 传输历史记录
- 自动病毒扫描集成

---

**注意**：当前版本的文件传输功能仍在开发中，目前只实现了文件传输请求的确认机制。完整的文件数据传输功能将在后续版本中提供。
